// Dark Mode Toggle
document.getElementById('dark-toggle').onclick = () => document.body.classList.toggle('dark');

// Expand modules
document.querySelectorAll('.expand-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    const body = btn.closest('.module-card').querySelector('.module-body');
    const show = body.classList.toggle('show');
    btn.style.transform = show ? 'rotate(180deg)' : 'rotate(0)';
  });
});

// Quiz Logic
document.querySelectorAll('.module-card').forEach(card => {
  const submit = card.querySelector('.submit-quiz');
  const radios = card.querySelectorAll('input[type=radio]');
  const result = card.querySelector('.quiz-result');
  radios.forEach(r => r.addEventListener('change', () => submit.disabled = false));
  submit.addEventListener('click', () => {
    const correctIdx = 0; // adjust per module
    const selected = [...radios].find(r => r.checked);
    if (!selected) return;
    result.textContent = selected.value == correctIdx ? '✅ Correct!' : '❌ Incorrect.';
    submit.disabled = true;
  });
});

// Chat Assistant
const chatBtn = document.getElementById('chat-float');
const chatPanel = document.getElementById('chat-panel');
const chatClose = document.getElementById('chat-close');
const chatForm = document.getElementById('chat-form');
const chatLog = document.getElementById('chat-log');

chatBtn.addEventListener('click', () => chatPanel.style.display = 'flex');
chatClose?.addEventListener('click', () => chatPanel.style.display = 'none');

chatForm.addEventListener('submit', e => {
  e.preventDefault();
  const msg = e.target[0].value.trim();
  if (!msg) return;

  const line = document.createElement('div');
  line.textContent = 'You: ' + msg;
  chatLog.appendChild(line);

  setTimeout(() => {
    const reply = aiReply(msg);
    const botLine = document.createElement('div');
    botLine.textContent = 'Bot: ' + reply;
    chatLog.appendChild(botLine);
    chatLog.scrollTop = chatLog.scrollHeight;
  }, 700);

  e.target.reset();
});

function aiReply(text) {
  const t = text.toLowerCase();
  if (t.includes('seo')) return 'SEO improves your visibility and ranking.';
  if (t.includes('social')) return 'Use Social Media to build brand and engage audience.';
  if (t.includes('google ads') || t.includes('ads')) return 'Google Ads lets you run paid campaigns.';
  if (t.includes('email')) return 'Email marketing helps nurture leads.';
  if (t.includes('analytics')) return 'Analytics tracks your website performance.';
  return "Sorry, I don't know that yet!";
}